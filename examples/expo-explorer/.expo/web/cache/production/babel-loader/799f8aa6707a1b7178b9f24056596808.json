{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");var _interopRequireWildcard=require(\"@babel/runtime/helpers/interopRequireWildcard\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));var _slicedToArray2=_interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));var _objectWithoutProperties2=_interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));var _react=_interopRequireWildcard(require(\"react\"));var _Popper=require(\"../Popper\");var _utils=require(\"../../../utils\");var _hooks=require(\"../../../hooks\");var _PopoverContext=require(\"./PopoverContext\");var _Box=_interopRequireDefault(require(\"../../primitives/Box\"));var _overlays=require(\"@react-native-aria/overlays\");var _Backdrop=_interopRequireDefault(require(\"../Backdrop\"));var _focus=require(\"@react-native-aria/focus\");var _Transitions=require(\"../Transitions\");var _reactNative=require(\"react-native-web/dist/index\");var _utils2=require(\"@react-aria/utils\");var _this=this,_jsxFileName=\"/Users/adityajamuar/Sites/projects/nativebase/NativeBase/src/components/composites/Popover/Popover.tsx\";var Popover=function Popover(_ref,ref){var onOpen=_ref.onOpen,trigger=_ref.trigger,onClose=_ref.onClose,isOpenProp=_ref.isOpen,children=_ref.children,defaultIsOpen=_ref.defaultIsOpen,initialFocusRef=_ref.initialFocusRef,finalFocusRef=_ref.finalFocusRef,_ref$trapFocus=_ref.trapFocus,trapFocus=_ref$trapFocus===void 0?true:_ref$trapFocus,rest=(0,_objectWithoutProperties2.default)(_ref,[\"onOpen\",\"trigger\",\"onClose\",\"isOpen\",\"children\",\"defaultIsOpen\",\"initialFocusRef\",\"finalFocusRef\",\"trapFocus\"]);var triggerRef=_react.default.useRef(null);var mergedRef=(0,_utils.mergeRefs)([triggerRef]);var _useControllableState=(0,_hooks.useControllableState)({value:isOpenProp,defaultValue:defaultIsOpen,onChange:function onChange(value){value?onOpen&&onOpen():onClose&&onClose();}}),_useControllableState2=(0,_slicedToArray2.default)(_useControllableState,2),isOpen=_useControllableState2[0],setIsOpen=_useControllableState2[1];var _React$useState=_react.default.useState(false),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),bodyMounted=_React$useState2[0],setBodyMounted=_React$useState2[1];var _React$useState3=_react.default.useState(false),_React$useState4=(0,_slicedToArray2.default)(_React$useState3,2),headerMounted=_React$useState4[0],setHeaderMounted=_React$useState4[1];var popoverContentId=(0,_utils2.useId)()+\"-content\";var headerId=popoverContentId+\"-header\";var bodyId=popoverContentId+\"-body\";var handleOpen=_react.default.useCallback(function(){setIsOpen(true);},[setIsOpen]);var updatedTrigger=function updatedTrigger(){return trigger({'ref':mergedRef,'onPress':handleOpen,'aria-expanded':isOpen?true:false,'aria-controls':isOpen?popoverContentId:undefined,'aria-haspopup':true},{open:isOpen});};var handleClose=function handleClose(){setIsOpen(false);};return _react.default.createElement(_Box.default,{ref:ref,__self:_this,__source:{fileName:_jsxFileName,lineNumber:69,columnNumber:5}},updatedTrigger(),_react.default.createElement(_overlays.OverlayContainer,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:71,columnNumber:7}},_react.default.createElement(_Transitions.PresenceTransition,{initial:{opacity:0},animate:{opacity:1,transition:{duration:150}},exit:{opacity:0,scale:0.95,transition:{duration:100}},visible:isOpen,style:_reactNative.StyleSheet.absoluteFill,__self:_this,__source:{fileName:_jsxFileName,lineNumber:72,columnNumber:9}},_react.default.createElement(_Popper.Popper,(0,_extends2.default)({onClose:handleClose,triggerRef:triggerRef},rest,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:79,columnNumber:11}}),_react.default.createElement(_Backdrop.default,{onPress:handleClose,bg:\"transparent\",__self:_this,__source:{fileName:_jsxFileName,lineNumber:80,columnNumber:13}}),_react.default.createElement(_PopoverContext.PopoverContext.Provider,{value:{onClose:handleClose,initialFocusRef:initialFocusRef,finalFocusRef:finalFocusRef,popoverContentId:popoverContentId,bodyId:bodyId,headerId:headerId,headerMounted:headerMounted,bodyMounted:bodyMounted,setBodyMounted:setBodyMounted,setHeaderMounted:setHeaderMounted},__self:_this,__source:{fileName:_jsxFileName,lineNumber:81,columnNumber:13}},_react.default.createElement(_focus.FocusScope,{contain:trapFocus,restoreFocus:true,autoFocus:true,__self:_this,__source:{fileName:_jsxFileName,lineNumber:95,columnNumber:15}},children))))));};var _default=(0,_react.memo)((0,_react.forwardRef)(Popover));exports.default=_default;","map":{"version":3,"sources":["Popover.tsx"],"names":["Popover","onOpen","trigger","onClose","isOpen","isOpenProp","children","defaultIsOpen","initialFocusRef","finalFocusRef","trapFocus","rest","triggerRef","React","mergedRef","setIsOpen","value","defaultValue","onChange","bodyMounted","setBodyMounted","headerMounted","setHeaderMounted","popoverContentId","headerId","bodyId","handleOpen","updatedTrigger","open","handleClose","opacity","transition","duration","scale","StyleSheet"],"mappings":"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","sourcesContent":["import React, { forwardRef, memo } from 'react';\nimport { Popper } from '../Popper';\nimport type { IPopoverProps } from './types';\nimport { mergeRefs } from '../../../utils';\nimport { useControllableState } from '../../../hooks';\nimport { PopoverContext } from './PopoverContext';\nimport Box from '../../primitives/Box';\nimport { OverlayContainer } from '@react-native-aria/overlays';\nimport Backdrop from '../Backdrop';\nimport { FocusScope } from '@react-native-aria/focus';\nimport { PresenceTransition } from '../Transitions';\nimport { StyleSheet } from 'react-native';\nimport { useId } from '@react-aria/utils';\n\nconst Popover = (\n  {\n    onOpen,\n    trigger,\n    onClose,\n    isOpen: isOpenProp,\n    children,\n    defaultIsOpen,\n    initialFocusRef,\n    finalFocusRef,\n    trapFocus = true,\n    ...rest\n  }: IPopoverProps,\n  ref: any\n) => {\n  const triggerRef = React.useRef(null);\n  const mergedRef = mergeRefs([triggerRef]);\n  const [isOpen, setIsOpen] = useControllableState({\n    value: isOpenProp,\n    defaultValue: defaultIsOpen,\n    onChange: (value) => {\n      value ? onOpen && onOpen() : onClose && onClose();\n    },\n  });\n\n  const [bodyMounted, setBodyMounted] = React.useState(false);\n  const [headerMounted, setHeaderMounted] = React.useState(false);\n\n  const popoverContentId = `${useId()}-content`;\n  const headerId = `${popoverContentId}-header`;\n  const bodyId = `${popoverContentId}-body`;\n\n  const handleOpen = React.useCallback(() => {\n    setIsOpen(true);\n  }, [setIsOpen]);\n\n  let updatedTrigger = () => {\n    return trigger(\n      {\n        'ref': mergedRef,\n        'onPress': handleOpen,\n        'aria-expanded': isOpen ? true : false,\n        'aria-controls': isOpen ? popoverContentId : undefined,\n        'aria-haspopup': true,\n      },\n      { open: isOpen }\n    );\n  };\n\n  const handleClose = () => {\n    setIsOpen(false);\n  };\n\n  return (\n    <Box ref={ref}>\n      {updatedTrigger()}\n      <OverlayContainer>\n        <PresenceTransition\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1, transition: { duration: 150 } }}\n          exit={{ opacity: 0, scale: 0.95, transition: { duration: 100 } }}\n          visible={isOpen}\n          style={StyleSheet.absoluteFill}\n        >\n          <Popper onClose={handleClose} triggerRef={triggerRef} {...rest}>\n            <Backdrop onPress={handleClose} bg=\"transparent\" />\n            <PopoverContext.Provider\n              value={{\n                onClose: handleClose,\n                initialFocusRef,\n                finalFocusRef,\n                popoverContentId,\n                bodyId,\n                headerId,\n                headerMounted,\n                bodyMounted,\n                setBodyMounted,\n                setHeaderMounted,\n              }}\n            >\n              <FocusScope contain={trapFocus} restoreFocus autoFocus>\n                {children}\n              </FocusScope>\n            </PopoverContext.Provider>\n          </Popper>\n        </PresenceTransition>\n      </OverlayContainer>\n    </Box>\n  );\n};\n\nexport default memo(forwardRef(Popover));\n"]},"metadata":{},"sourceType":"script"}