{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));var _toConsumableArray2=_interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));var _slicedToArray2=_interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));var _objectWithoutProperties2=_interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));var _react=_interopRequireDefault(require(\"react\"));var _Stack=require(\"../../primitives/Stack\");var _hooks=require(\"../../../hooks\");var _FormControl=require(\"../FormControl\");var _reactNative=require(\"react-native-web/dist/index\");var _Context=require(\"./Context\");var _theme=require(\"../../../theme\");var _this=this,_jsxFileName=\"/Users/adityajamuar/Sites/projects/nativebase/NativeBase/src/components/composites/PinInput/PinInput.tsx\";var PinInput=function PinInput(_ref,ref){var children=_ref.children,props=(0,_objectWithoutProperties2.default)(_ref,[\"children\"]);var _themeTools$extractIn=_theme.themeTools.extractInObject(props,['p','px','py','pt','pb','pl','pr']),_themeTools$extractIn2=(0,_slicedToArray2.default)(_themeTools$extractIn,2),padding=_themeTools$extractIn2[0],remProps=_themeTools$extractIn2[1];var _useThemeProps=(0,_hooks.useThemeProps)('PinInput',remProps),manageFocus=_useThemeProps.manageFocus,defaultValue=_useThemeProps.defaultValue,value=_useThemeProps.value,space=_useThemeProps.space,onChange=_useThemeProps.onChange,newProps=(0,_objectWithoutProperties2.default)(_useThemeProps,[\"manageFocus\",\"defaultValue\",\"value\",\"space\",\"onChange\"]);var formControlContext=(0,_FormControl.useFormControlContext)();var RefList=[];var setRefList=function setRefList(ref,index){RefList[index]=ref;};var _React$useState=_react.default.useState(value||defaultValue),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),pinInputValue=_React$useState2[0],setPinInputValue=_React$useState2[1];var handleChange=function handleChange(newValue,fieldIndex){var temp=pinInputValue&&(0,_toConsumableArray2.default)(pinInputValue)||[];temp[fieldIndex]=newValue;value===undefined&&setPinInputValue(temp.join(''));onChange&&onChange(temp.join(''));if(newValue===''&&manageFocus&&fieldIndex-1>-1)RefList[fieldIndex-1].current.focus();else if(newValue&&manageFocus&&fieldIndex+1<RefList.length)RefList[fieldIndex+1].current.focus();return temp.join('');};var handleMultiValueChange=function handleMultiValueChange(newValue,fieldIndex){var pinFieldLength=RefList.length;var newValueLength=newValue.length;if(newValueLength>=pinFieldLength&&newValueLength>2){var splicedValue=newValue?(0,_toConsumableArray2.default)(newValue):[];splicedValue.splice(pinFieldLength);RefList[pinFieldLength-1].current.focus();setPinInputValue(splicedValue.join(''));onChange&&onChange(splicedValue.join(''));}if(_reactNative.Platform.OS!=='ios'){var temp=pinInputValue?(0,_toConsumableArray2.default)(pinInputValue):[];if(newValue===''){temp=temp.filter(function(_n,i){return i!==fieldIndex;});if(manageFocus&&fieldIndex-1>-1)RefList[fieldIndex-1].current.focus();}else{temp[fieldIndex]=JSON.stringify(parseInt(newValue,10)%10);if(manageFocus&&fieldIndex+1<RefList.length)RefList[fieldIndex+1].current.focus();}value===undefined&&setPinInputValue(temp.join(''));onChange&&onChange(temp.join(''));}};var indexSetter=function indexSetter(allChildren){var pinInputFiledCounter=-1;return _react.default.Children.map(allChildren,function(child){pinInputFiledCounter++;return _react.default.cloneElement(child,{fieldIndex:pinInputFiledCounter},child.props.children);});};_react.default.useEffect(function(){if(value!==undefined&&value!=pinInputValue)setPinInputValue(value);},[value,pinInputValue,setPinInputValue]);return _react.default.createElement(_Context.PinInputContext.Provider,{value:(0,_extends2.default)({},formControlContext,newProps,{setRefList:setRefList,handleChange:handleChange,handleMultiValueChange:handleMultiValueChange,value:pinInputValue}),__self:_this,__source:{fileName:_jsxFileName,lineNumber:95,columnNumber:5}},children&&_react.default.createElement(_Stack.HStack,(0,_extends2.default)({flexDirection:\"row\",space:space},padding,{ref:ref,__self:_this,__source:{fileName:_jsxFileName,lineNumber:106,columnNumber:9}}),indexSetter(children)));};var _default=_react.default.memo(_react.default.forwardRef(PinInput));exports.default=_default;","map":{"version":3,"sources":["PinInput.tsx"],"names":["PinInput","children","props","padding","remProps","themeTools","manageFocus","defaultValue","value","space","onChange","newProps","formControlContext","RefList","setRefList","pinInputValue","setPinInputValue","React","handleChange","temp","newValue","fieldIndex","handleMultiValueChange","pinFieldLength","newValueLength","splicedValue","Platform","i","JSON","parseInt","indexSetter","pinInputFiledCounter","child"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { HStack } from '../../primitives/Stack';\nimport { useThemeProps } from '../../../hooks';\nimport type { IPinInputProps } from './types';\nimport { useFormControlContext } from '../FormControl';\nimport { Platform } from 'react-native';\nimport { PinInputContext } from './Context';\nimport { themeTools } from '../../../theme';\n\nconst PinInput = ({ children, ...props }: IPinInputProps, ref?: any) => {\n  let [padding, remProps] = themeTools.extractInObject(props, [\n    'p',\n    'px',\n    'py',\n    'pt',\n    'pb',\n    'pl',\n    'pr',\n  ]);\n  const {\n    manageFocus,\n    defaultValue,\n    value,\n    space,\n    onChange,\n    ...newProps\n  } = useThemeProps('PinInput', remProps);\n  const formControlContext = useFormControlContext();\n\n  const RefList: Array<any> = [];\n  const setRefList = (ref: any, index: number) => {\n    RefList[index] = ref;\n  };\n  const [pinInputValue, setPinInputValue] = React.useState(\n    value || defaultValue\n  );\n  const handleChange = (newValue: string, fieldIndex: number) => {\n    let temp = (pinInputValue && [...pinInputValue]) || [];\n    temp[fieldIndex] = newValue;\n    value === undefined && setPinInputValue(temp.join(''));\n    onChange && onChange(temp.join(''));\n    if (newValue === '' && manageFocus && fieldIndex - 1 > -1)\n      RefList[fieldIndex - 1].current.focus();\n    else if (newValue && manageFocus && fieldIndex + 1 < RefList.length)\n      RefList[fieldIndex + 1].current.focus();\n    return temp.join('');\n  };\n  const handleMultiValueChange = (newValue: string, fieldIndex: number) => {\n    const pinFieldLength = RefList.length;\n    const newValueLength = newValue.length;\n    if (newValueLength >= pinFieldLength && newValueLength > 2) {\n      let splicedValue = newValue ? [...newValue] : [];\n      splicedValue.splice(pinFieldLength);\n      RefList[pinFieldLength - 1].current.focus();\n      setPinInputValue(splicedValue.join(''));\n      onChange && onChange(splicedValue.join(''));\n    }\n\n    if (Platform.OS !== 'ios') {\n      let temp = pinInputValue ? [...pinInputValue] : [];\n      if (newValue === '') {\n        // Handling Backward focus.\n        temp = temp.filter((_n, i) => i !== fieldIndex);\n        if (manageFocus && fieldIndex - 1 > -1)\n          RefList[fieldIndex - 1].current.focus();\n      } else {\n        temp[fieldIndex] = JSON.stringify(parseInt(newValue, 10) % 10);\n        if (manageFocus && fieldIndex + 1 < RefList.length)\n          RefList[fieldIndex + 1].current.focus();\n      }\n      value === undefined && setPinInputValue(temp.join(''));\n      onChange && onChange(temp.join(''));\n    }\n  };\n\n  const indexSetter = (allChildren: JSX.Element | JSX.Element[]) => {\n    let pinInputFiledCounter = -1;\n    return React.Children.map(allChildren, (child: JSX.Element) => {\n      pinInputFiledCounter++;\n      return React.cloneElement(\n        child,\n        {\n          fieldIndex: pinInputFiledCounter,\n        },\n        child.props.children\n      );\n    });\n  };\n\n  React.useEffect(() => {\n    if (value !== undefined && value != pinInputValue) setPinInputValue(value);\n  }, [value, pinInputValue, setPinInputValue]);\n\n  return (\n    <PinInputContext.Provider\n      value={{\n        ...formControlContext,\n        ...newProps,\n        setRefList,\n        handleChange,\n        handleMultiValueChange,\n        value: pinInputValue,\n      }}\n    >\n      {children && (\n        <HStack flexDirection=\"row\" space={space} {...padding} ref={ref}>\n          {indexSetter(children)}\n        </HStack>\n      )}\n    </PinInputContext.Provider>\n  );\n};\n\nexport default React.memo(React.forwardRef(PinInput));\n"]},"metadata":{},"sourceType":"script"}