{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.Popper=void 0;var _objectWithoutProperties2=_interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));var _extends2=_interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));var _slicedToArray2=_interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));var _react=_interopRequireDefault(require(\"react\"));var _overlays=require(\"@react-native-aria/overlays\");var _reactNative=require(\"react-native-web/dist/index\");var _utils=require(\"../../../utils\");var _Box=_interopRequireDefault(require(\"../../primitives/Box\"));var _reactNativeSafeAreaContext=require(\"react-native-safe-area-context\");var _this=this,_jsxFileName=\"/Users/adityajamuar/Sites/projects/nativebase/NativeBase/src/components/composites/Popper/Popper.tsx\";var defaultArrowHeight=15;var defaultArrowWidth=15;var getDiagonalLength=function getDiagonalLength(height,width){return Math.pow(height*height+width*width,0.5);};var _createContext=(0,_utils.createContext)('PopperContext'),_createContext2=(0,_slicedToArray2.default)(_createContext,2),PopperProvider=_createContext2[0],usePopperContext=_createContext2[1];var Popper=function Popper(props){return _react.default.createElement(PopperProvider,(0,_extends2.default)({},props,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:38,columnNumber:10}}),props.children);};exports.Popper=Popper;var PopperContent=_react.default.forwardRef(function(_ref,ref){var children=_ref.children,style=_ref.style,rest=(0,_objectWithoutProperties2.default)(_ref,[\"children\",\"style\"]);var _usePopperContext=usePopperContext('PopperContent'),triggerRef=_usePopperContext.triggerRef,shouldFlip=_usePopperContext.shouldFlip,crossOffset=_usePopperContext.crossOffset,offset=_usePopperContext.offset,placementProp=_usePopperContext.placement,onClose=_usePopperContext.onClose,shouldOverlapWithTrigger=_usePopperContext.shouldOverlapWithTrigger,setOverlayRef=_usePopperContext.setOverlayRef;var overlayRef=_react.default.useRef(null);var _useSafeAreaInsets=(0,_reactNativeSafeAreaContext.useSafeAreaInsets)(),top=_useSafeAreaInsets.top;var _useOverlayPosition=(0,_overlays.useOverlayPosition)({targetRef:triggerRef,overlayRef:overlayRef,shouldFlip:shouldFlip,crossOffset:crossOffset,isOpen:true,offset:offset,placement:placementProp,containerPadding:0,onClose:onClose,shouldOverlapWithTrigger:shouldOverlapWithTrigger}),overlayProps=_useOverlayPosition.overlayProps,rendered=_useOverlayPosition.rendered,arrowProps=_useOverlayPosition.arrowProps,placement=_useOverlayPosition.placement;var restElements=[];var arrowElement=null;_react.default.useEffect(function(){setOverlayRef&&setOverlayRef(overlayRef);},[overlayRef,setOverlayRef]);_react.default.Children.forEach(children,function(child){if(_react.default.isValidElement(child)&&child.type.displayName==='PopperArrow'){arrowElement=_react.default.cloneElement(child,{arrowProps:arrowProps,actualPlacement:placement});}else{restElements.push(child);}});var arrowHeight=0;var arrowWidth=0;if(arrowElement){arrowHeight=defaultArrowHeight;arrowWidth=defaultArrowWidth;if(arrowElement.props.height){arrowHeight=arrowElement.props.height;}if(arrowElement.props.width){arrowWidth=arrowElement.props.width;}}var containerStyle=_react.default.useMemo(function(){return getContainerStyle({placement:placement,arrowHeight:arrowHeight,arrowWidth:arrowWidth});},[arrowHeight,arrowWidth,placement]);var overlayStyle=_react.default.useMemo(function(){return _reactNative.StyleSheet.create({overlay:(0,_extends2.default)({},overlayProps.style,{marginTop:_reactNative.Platform.select({android:top,default:0}),opacity:rendered?1:0,position:'absolute'})});},[rendered,overlayProps.style,top]);return _react.default.createElement(_reactNative.View,{ref:overlayRef,collapsable:false,style:overlayStyle.overlay,__self:_this,__source:{fileName:_jsxFileName,lineNumber:143,columnNumber:7}},arrowElement,_react.default.createElement(_Box.default,(0,_extends2.default)({style:_reactNative.StyleSheet.flatten([containerStyle,style])},rest,{ref:ref,__self:_this,__source:{fileName:_jsxFileName,lineNumber:145,columnNumber:9}}),restElements));});var PopperArrow=_react.default.forwardRef(function(_ref2,ref){var _ref2$height=_ref2.height,height=_ref2$height===void 0?defaultArrowHeight:_ref2$height,_ref2$width=_ref2.width,width=_ref2$width===void 0?defaultArrowWidth:_ref2$width,arrowProps=_ref2.arrowProps,actualPlacement=_ref2.actualPlacement,style=_ref2.style,_ref2$borderColor=_ref2.borderColor,borderColor=_ref2$borderColor===void 0?'#52525b':_ref2$borderColor,_ref2$backgroundColor=_ref2.backgroundColor,backgroundColor=_ref2$backgroundColor===void 0?'black':_ref2$backgroundColor,rest=(0,_objectWithoutProperties2.default)(_ref2,[\"height\",\"width\",\"arrowProps\",\"actualPlacement\",\"style\",\"borderColor\",\"backgroundColor\"]);var additionalStyles=_react.default.useMemo(function(){return getArrowStyles({placement:actualPlacement,height:height,width:width});},[actualPlacement,height,width]);var triangleStyle=_react.default.useMemo(function(){return{position:'absolute',width:width,height:height};},[width,height]);var arrowStyles=_react.default.useMemo(function(){return[arrowProps.style,triangleStyle,additionalStyles,style];},[triangleStyle,additionalStyles,arrowProps.style,style]);return _react.default.createElement(_Box.default,(0,_extends2.default)({ref:ref,style:arrowStyles,borderColor:borderColor,backgroundColor:backgroundColor,zIndex:1},rest,{__self:_this,__source:{fileName:_jsxFileName,lineNumber:195,columnNumber:7}}));});var getArrowStyles=function getArrowStyles(props){var additionalStyles={transform:[]};var diagonalLength=getDiagonalLength(defaultArrowHeight,defaultArrowHeight);if(props.placement==='top'&&props.width){additionalStyles.transform.push({translateX:-props.width/2});additionalStyles.transform.push({rotate:'45deg'});additionalStyles.bottom=Math.ceil((diagonalLength-defaultArrowHeight)/2);additionalStyles.borderBottomWidth=1;additionalStyles.borderRightWidth=1;}if(props.placement==='bottom'&&props.width){additionalStyles.transform.push({translateX:-props.width/2});additionalStyles.transform.push({rotate:'45deg'});additionalStyles.top=Math.ceil((diagonalLength-defaultArrowHeight)/2);additionalStyles.borderTopWidth=1;additionalStyles.borderLeftWidth=1;}if(props.placement==='left'&&props.height){additionalStyles.transform.push({translateY:-props.height/2});additionalStyles.transform.push({rotate:'45deg'});additionalStyles.right=Math.ceil((diagonalLength-defaultArrowHeight)/2);additionalStyles.borderTopWidth=1;additionalStyles.borderRightWidth=1;}if(props.placement==='right'&&props.height){additionalStyles.transform.push({translateY:-props.height/2});additionalStyles.transform.push({rotate:'45deg'});additionalStyles.left=Math.ceil((diagonalLength-defaultArrowHeight)/2);additionalStyles.borderBottomWidth=1;additionalStyles.borderLeftWidth=1;}return additionalStyles;};var getContainerStyle=function getContainerStyle(_ref3){var placement=_ref3.placement,arrowHeight=_ref3.arrowHeight;var diagonalLength=getDiagonalLength(arrowHeight,arrowHeight)/2;if(placement==='top'){return{marginBottom:diagonalLength};}if(placement==='bottom'){return{marginTop:diagonalLength};}if(placement==='left'){return{marginRight:diagonalLength};}if(placement==='right'){return{marginLeft:diagonalLength};}return{};};PopperArrow.displayName='PopperArrow';Popper.Content=PopperContent;Popper.Arrow=PopperArrow;","map":{"version":3,"sources":["Popper.tsx"],"names":["defaultArrowHeight","defaultArrowWidth","getDiagonalLength","Math","height","width","PopperProvider","usePopperContext","Popper","props","PopperContent","React","children","style","rest","triggerRef","shouldFlip","crossOffset","offset","placementProp","onClose","shouldOverlapWithTrigger","setOverlayRef","overlayRef","top","overlayProps","rendered","arrowProps","placement","targetRef","isOpen","containerPadding","restElements","arrowElement","child","actualPlacement","arrowHeight","arrowWidth","containerStyle","getContainerStyle","overlayStyle","StyleSheet","overlay","marginTop","Platform","android","default","opacity","position","PopperArrow","borderColor","backgroundColor","additionalStyles","getArrowStyles","triangleStyle","arrowStyles","transform","diagonalLength","translateX","rotate","translateY","marginBottom","marginRight","marginLeft"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useOverlayPosition } from '@react-native-aria/overlays';\nimport { Platform, StyleSheet, View, ViewStyle } from 'react-native';\nimport type {\n  IPopperProps,\n  IScrollContentStyle,\n  IArrowStyles,\n  IPopoverArrowProps,\n} from './types';\nimport { createContext } from '../../../utils';\nimport Box, { IBoxProps } from '../../primitives/Box';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\n\nconst defaultArrowHeight = 15;\nconst defaultArrowWidth = 15;\n\nconst getDiagonalLength = (height: number, width: number) => {\n  return Math.pow(height * height + width * width, 0.5);\n};\n\ntype PopperContext = IPopperProps & {\n  triggerRef: any;\n  onClose: any;\n  setOverlayRef?: (overlayRef: any) => void;\n};\n\nconst [PopperProvider, usePopperContext] = createContext<PopperContext>(\n  'PopperContext'\n);\n\nconst Popper = (\n  props: IPopperProps & {\n    triggerRef: any;\n    onClose: any;\n    setOverlayRef?: (overlayRef: any) => void;\n  }\n) => {\n  return <PopperProvider {...props}>{props.children}</PopperProvider>;\n};\n\nconst PopperContent = React.forwardRef(\n  ({ children, style, ...rest }: IBoxProps, ref: any) => {\n    const {\n      triggerRef,\n      shouldFlip,\n      crossOffset,\n      offset,\n      placement: placementProp,\n      onClose,\n      shouldOverlapWithTrigger,\n      setOverlayRef,\n    } = usePopperContext('PopperContent');\n    const overlayRef = React.useRef(null);\n    const { top } = useSafeAreaInsets();\n    const {\n      overlayProps,\n      rendered,\n      arrowProps,\n      placement,\n    } = useOverlayPosition({\n      targetRef: triggerRef,\n      overlayRef,\n      shouldFlip: shouldFlip,\n      crossOffset: crossOffset,\n      isOpen: true,\n      offset: offset,\n      placement: placementProp as any,\n      containerPadding: 0,\n      onClose: onClose,\n      shouldOverlapWithTrigger,\n    });\n\n    let restElements: React.ReactNode[] = [];\n    let arrowElement: React.ReactElement | null = null;\n\n    React.useEffect(() => {\n      setOverlayRef && setOverlayRef(overlayRef);\n    }, [overlayRef, setOverlayRef]);\n\n    // Might have performance impact if there are a lot of siblings!\n    // Shouldn't be an issue with popovers since it would have atmost 2. Arrow and Content.\n    React.Children.forEach(children, (child) => {\n      if (\n        React.isValidElement(child) &&\n        // @ts-ignore\n        child.type.displayName === 'PopperArrow'\n      ) {\n        arrowElement = React.cloneElement(child, {\n          // @ts-ignore\n          arrowProps,\n          actualPlacement: placement,\n        });\n      } else {\n        restElements.push(child);\n      }\n    });\n\n    let arrowHeight = 0;\n    let arrowWidth = 0;\n\n    if (arrowElement) {\n      arrowHeight = defaultArrowHeight;\n      arrowWidth = defaultArrowWidth;\n\n      //@ts-ignore\n      if (arrowElement.props.height) {\n        //@ts-ignore\n        arrowHeight = arrowElement.props.height;\n      }\n\n      //@ts-ignore\n      if (arrowElement.props.width) {\n        //@ts-ignore\n        arrowWidth = arrowElement.props.width;\n      }\n    }\n\n    const containerStyle = React.useMemo(\n      () =>\n        getContainerStyle({\n          placement,\n          arrowHeight,\n          arrowWidth,\n        }),\n      [arrowHeight, arrowWidth, placement]\n    );\n\n    const overlayStyle = React.useMemo(\n      () =>\n        StyleSheet.create({\n          overlay: {\n            ...overlayProps.style,\n            // To handle translucent android StatusBar\n            marginTop: Platform.select({ android: top, default: 0 }),\n            opacity: rendered ? 1 : 0,\n            position: 'absolute',\n          },\n        }),\n      [rendered, overlayProps.style, top]\n    );\n\n    return (\n      <View ref={overlayRef} collapsable={false} style={overlayStyle.overlay}>\n        {arrowElement}\n        <Box\n          style={StyleSheet.flatten([containerStyle, style])}\n          {...rest}\n          ref={ref}\n        >\n          {restElements}\n        </Box>\n      </View>\n    );\n  }\n);\n\n// This is an internal implementation of PopoverArrow\nconst PopperArrow = React.forwardRef(\n  (\n    {\n      height = defaultArrowHeight,\n      width = defaultArrowWidth,\n\n      //@ts-ignore - Will be passed by React.cloneElement from PopperContent\n      arrowProps,\n      //@ts-ignore - Will be passed by React.cloneElement from PopperContent\n      actualPlacement,\n      style,\n      borderColor = '#52525b',\n      backgroundColor = 'black',\n      ...rest\n    }: IPopoverArrowProps & IBoxProps,\n    ref: any\n  ) => {\n    const additionalStyles = React.useMemo(\n      () => getArrowStyles({ placement: actualPlacement, height, width }),\n      [actualPlacement, height, width]\n    );\n\n    let triangleStyle: ViewStyle = React.useMemo(\n      () => ({\n        position: 'absolute',\n        width,\n        height,\n      }),\n      [width, height]\n    );\n\n    let arrowStyles = React.useMemo(\n      () => [arrowProps.style, triangleStyle, additionalStyles, style],\n      [triangleStyle, additionalStyles, arrowProps.style, style]\n    );\n\n    return (\n      <Box\n        ref={ref}\n        style={arrowStyles}\n        borderColor={borderColor}\n        backgroundColor={backgroundColor}\n        zIndex={1}\n        {...rest}\n      />\n    );\n  }\n);\n\nconst getArrowStyles = (props: IArrowStyles) => {\n  let additionalStyles: any = {\n    transform: [],\n  };\n\n  const diagonalLength = getDiagonalLength(\n    defaultArrowHeight,\n    defaultArrowHeight\n  );\n\n  if (props.placement === 'top' && props.width) {\n    additionalStyles.transform.push({ translateX: -props.width / 2 });\n    additionalStyles.transform.push({ rotate: '45deg' });\n    additionalStyles.bottom = Math.ceil(\n      (diagonalLength - defaultArrowHeight) / 2\n    );\n    additionalStyles.borderBottomWidth = 1;\n    additionalStyles.borderRightWidth = 1;\n  }\n\n  if (props.placement === 'bottom' && props.width) {\n    additionalStyles.transform.push({ translateX: -props.width / 2 });\n    additionalStyles.transform.push({ rotate: '45deg' });\n    additionalStyles.top = Math.ceil((diagonalLength - defaultArrowHeight) / 2);\n    additionalStyles.borderTopWidth = 1;\n    additionalStyles.borderLeftWidth = 1;\n  }\n\n  if (props.placement === 'left' && props.height) {\n    additionalStyles.transform.push({ translateY: -props.height / 2 });\n    additionalStyles.transform.push({ rotate: '45deg' });\n    additionalStyles.right = Math.ceil(\n      (diagonalLength - defaultArrowHeight) / 2\n    );\n    additionalStyles.borderTopWidth = 1;\n    additionalStyles.borderRightWidth = 1;\n  }\n\n  if (props.placement === 'right' && props.height) {\n    additionalStyles.transform.push({ translateY: -props.height / 2 });\n    additionalStyles.transform.push({ rotate: '45deg' });\n    additionalStyles.left = Math.ceil(\n      (diagonalLength - defaultArrowHeight) / 2\n    );\n    additionalStyles.borderBottomWidth = 1;\n    additionalStyles.borderLeftWidth = 1;\n  }\n\n  return additionalStyles;\n};\n\nconst getContainerStyle = ({ placement, arrowHeight }: IScrollContentStyle) => {\n  const diagonalLength = getDiagonalLength(arrowHeight, arrowHeight) / 2;\n\n  if (placement === 'top') {\n    return { marginBottom: diagonalLength };\n  }\n\n  if (placement === 'bottom') {\n    return { marginTop: diagonalLength };\n  }\n\n  if (placement === 'left') {\n    return { marginRight: diagonalLength };\n  }\n\n  if (placement === 'right') {\n    return { marginLeft: diagonalLength };\n  }\n\n  return {};\n};\n\nPopperArrow.displayName = 'PopperArrow';\nPopper.Content = PopperContent;\nPopper.Arrow = PopperArrow;\n\nexport { Popper };\n"]},"metadata":{},"sourceType":"script"}